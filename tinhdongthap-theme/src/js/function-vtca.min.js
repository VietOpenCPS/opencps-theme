var certChainUserVtCa="",signatureBase64VtCa="",VtPluginSocket={hSession:"",initPlugin:function(){var t=["viettel-ca_v5.dll;viettel-ca_v4.dll;viettel-ca_v2.dll;viettel-ca_v5.dylib;viettel-ca_v4.dylib"],n=this.ajaxFunction("getSession",["liblist"],t);return""!=n&&(this.hSession=n,!0)},getCert:function(){var t="";if(null==this.hSession||null==this.hSession||""==this.hSession)return t;var n=[this.hSession],e=this.ajaxFunction("getCertificate",["sessionID"],n);return""!=e&&(t=e,certChainUserVtCa=e),t},signHash:function(t){var n="";if(null==this.hSession||null==this.hSession||""==this.hSession||null==t||null==t||""==t)return n;var e=[this.hSession,this.convertBase64ToHexa(t),0],i=this.ajaxFunction("signHash",["sessionID","HashVal","HashOpt"],e);return""!=i&&(n=i,signatureBase64VtCa=i),n},getLastErrorCode:function(){var t="",n=this.ajaxFunction("getLastErr");return""!=n&&(t=n),t},ajaxFunction:function(t,n,e){var i,r="";if(null==t||null==t||""==t.trim())return r;(i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).onreadystatechange=function(){4==i.readyState&&200==i.status&&(r=i.responseText)};var s="http://localhost:14007/"+t;if(i.open("POST",s,!1),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),null!=n&&null!=n&&Array.isArray(n)&&0!=n.length&&null!=e&&null!=e&&Array.isArray(e)&&0!=e.length&&n.length==e.length){for(var a="",h=0;h<n.length;h++)a+=n[h]+"="+e[h]+"&";a.length>0&&(a=a.substring(0,a.length-1)),i.send(a)}else try{i.send()}catch(t){return r}return r},dec2hex:function(t){for(var n="0123456789ABCDEF",e=n.substr(15&t,1);t>15;)e=n.substr(15&(t>>=4),1)+e;return e},base64_decode:function(t){var n,e,i,r,s,a,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=new Array,o=0;if(t!=(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""))&&alert("Warning! Characters outside Base64 range in input string ignored."),t.length%4)return alert("Error: Input length is not a multiple of 4 bytes."),"";for(var u=0;o<t.length;)n=h.indexOf(t.charAt(o++))<<2|(r=h.indexOf(t.charAt(o++)))>>4,e=(15&r)<<4|(s=h.indexOf(t.charAt(o++)))>>2,i=(3&s)<<6|(a=h.indexOf(t.charAt(o++))),l[u++]=n,64!=s&&(l[u++]=e),64!=a&&(l[u++]=i);return l},convertBase64ToHexa:function(t){var n=this.base64_decode(t),e="";for(i=0;i<n.length;i++)e=e+""+(n[i]<16?"0":"")+this.dec2hex(n[i]);return e},ERROR_CODE:{100100:"Lỗi chọn CTS",100101:"Lỗi Plugin",100102:"CTS không hợp lệ",100103:"Session không hợp lệ",100104:"CTS hết hạn",100200:"Dữ liệu lỗi",100201:"Không tìm thấy CTS",100202:"CTS không hợp lệ",100203:"Lỗi xảy ra trong quá trình ký",100204:"Tràn bộ nhớ",100205:"Session không hợp lệ",100300:"Chữ ký không đúng định dạng",100301:"Lỗi phân tích CTS",100302:"Chữ ký không hợp lệ",100303:"Session không hợp lệ"}};